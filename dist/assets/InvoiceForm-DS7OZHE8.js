import{r as d,j as e,aL as I,aM as _,I as W,aS as z,aN as O,bf as s,ag as k,V as a,B as v,n as j,L as K,F as Q,H as R,J as f,K as U,M as y,ar as X,ac as J,ad as E,ae as G,aO as q,bg as Z,q as $,aU as ee,af as te,S as ae,bh as ne}from"./index-BDZEQFom.js";const se=({open:b,onClose:o,onSave:A,initialRows:i=[]})=>{const[n,h]=d.useState([{taxCode:"",description:"",amount:""}]);d.useEffect(()=>{b&&(i.length>0?h(i):h([{taxCode:"",description:"",amount:""}]))},[b]);const r=(m,C,p)=>{const u=[...n];u[m][C]=p,h(u)};return e.jsxs(I,{open:b,onClose:o,fullWidth:!0,maxWidth:!1,PaperProps:{sx:{width:900,maxWidth:900,borderRadius:3}},children:[e.jsxs(_,{sx:{textAlign:"center",fontWeight:700,color:"#6C2BD9"},children:["Tax Details",e.jsx(W,{onClick:o,sx:{position:"absolute",left:10,top:10},children:e.jsx(z,{})})]}),e.jsxs(O,{children:[e.jsxs(s,{container:!0,spacing:2,mb:1,children:[e.jsx(s,{item:!0,xs:4,children:e.jsx(k,{fontWeight:600,children:"Tax Code"})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(k,{fontWeight:600,children:"Description"})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(k,{fontWeight:600,children:"Amount"})})]}),n.map((m,C)=>e.jsxs(s,{container:!0,spacing:2,mb:2,children:[e.jsx(s,{item:!0,xs:4,children:e.jsx(a,{fullWidth:!0,size:"small",value:m.taxCode,onChange:p=>r(C,"taxCode",p.target.value)})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(a,{fullWidth:!0,size:"small",value:m.description,onChange:p=>r(C,"description",p.target.value)})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(a,{fullWidth:!0,size:"small",type:"number",value:m.amount,onChange:p=>r(C,"amount",p.target.value)})})]},C)),e.jsxs(v,{display:"flex",justifyContent:"flex-end",gap:2,mt:3,children:[e.jsx(j,{variant:"contained",sx:{backgroundColor:"#6C2BD9"},onClick:o,children:"Close"}),e.jsx(j,{variant:"contained",sx:{backgroundColor:"#6C2BD9"},onClick:()=>A(n),children:"Save"})]})]})]})},le=({open:b,onClose:o,onSave:A})=>{const[i,n]=d.useState({percentage:"",description:"",paymentMode:"",period:""}),[h,r]=d.useState([]);d.useEffect(()=>{b&&(r([]),n({percentage:"",description:"",paymentMode:"",period:""}))},[b]);const m=u=>{const{name:N,value:P}=u.target;n(S=>({...S,[N]:P}))},C=()=>{!i.percentage||!i.description||(r(u=>[...u,i]),n({percentage:"",description:"",paymentMode:"",period:""}))},p=u=>{r(N=>N.filter((P,S)=>S!==u))};return e.jsxs(I,{open:b,onClose:o,fullWidth:!0,maxWidth:!1,PaperProps:{sx:{width:900,maxWidth:900}},children:[e.jsxs(_,{children:["Payment Terms",e.jsx(W,{onClick:o,sx:{position:"absolute",right:8,top:8},children:e.jsx(z,{})})]}),e.jsxs(O,{children:[e.jsxs(K,{size:"small",children:[e.jsx(Q,{children:e.jsxs(R,{children:[e.jsx(f,{children:"%"}),e.jsx(f,{children:"Description"}),e.jsx(f,{children:"Payment Mode"}),e.jsx(f,{children:"Period"}),e.jsx(f,{align:"center",children:"Action"})]})}),e.jsx(U,{children:h.length>0?h.map((u,N)=>e.jsxs(R,{children:[e.jsx(f,{children:u.percentage}),e.jsx(f,{children:u.description}),e.jsx(f,{children:u.paymentMode}),e.jsx(f,{children:u.period}),e.jsx(f,{align:"center",children:e.jsx(j,{size:"small",variant:"contained",color:"error",onClick:()=>p(N),children:"Delete"})})]},N)):e.jsx(R,{children:e.jsx(f,{colSpan:5,align:"center",children:"No payment terms added"})})})]}),e.jsxs(v,{mt:3,children:[e.jsxs(s,{container:!0,spacing:2,children:[e.jsx(s,{item:!0,xs:3,children:e.jsx(a,{label:"Percentage",name:"percentage",value:i.percentage,onChange:m,fullWidth:!0,size:"small"})}),e.jsx(s,{item:!0,xs:3,children:e.jsxs(a,{select:!0,label:"Description",name:"description",value:i.description,onChange:m,fullWidth:!0,size:"small",children:[e.jsx(y,{value:"",children:"-- Select --"}),e.jsx(y,{value:"Advance",children:"Advance"}),e.jsx(y,{value:"Against Delivery",children:"Against Delivery"}),e.jsx(y,{value:"Credit",children:"Credit"})]})}),e.jsx(s,{item:!0,xs:3,children:e.jsxs(a,{select:!0,label:"Payment Mode",name:"paymentMode",value:i.paymentMode,onChange:m,fullWidth:!0,size:"small",children:[e.jsx(y,{value:"",children:"-- Select --"}),e.jsx(y,{value:"Cash",children:"Cash"}),e.jsx(y,{value:"Cheque",children:"Cheque"}),e.jsx(y,{value:"NEFT",children:"NEFT"}),e.jsx(y,{value:"RTGS",children:"RTGS"})]})}),e.jsx(s,{item:!0,xs:3,children:e.jsx(a,{label:"Period (Days)",name:"period",value:i.period,onChange:m,fullWidth:!0,size:"small"})})]}),e.jsx(v,{mt:2,textAlign:"right",children:e.jsx(j,{variant:"contained",onClick:C,children:"Add"})})]}),e.jsxs(v,{display:"flex",justifyContent:"flex-end",gap:2,mt:4,children:[e.jsx(j,{variant:"contained",onClick:()=>A(h),children:"Save"}),e.jsx(j,{variant:"outlined",onClick:o,children:"Close"})]})]})]})},ie=({open:b,handleClose:o,onSave:A,initialData:i})=>{const[n,h]=d.useState({insurance:"N.A",deliveryTerm:"",labReport:""});d.useEffect(()=>{i&&h(i)},[i]);const r=C=>{const{name:p,value:u}=C.target;h({...n,[p]:u})},m=()=>{A(n),o()};return e.jsxs(I,{open:b,onClose:o,maxWidth:"md",fullWidth:!0,children:[e.jsxs(_,{sx:{color:"#6C2BD9",fontWeight:600},children:["Other Details",e.jsx(W,{onClick:o,sx:{position:"absolute",right:10,top:10},children:e.jsx(z,{})})]}),e.jsx(O,{dividers:!0,children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsxs(s,{item:!0,xs:12,children:[e.jsx(k,{variant:"subtitle1",children:"Insurance"}),e.jsx(X,{children:e.jsxs(J,{row:!0,name:"insurance",value:n.insurance,onChange:r,children:[e.jsx(E,{value:"Our A/c",control:e.jsx(G,{}),label:"Our A/c"}),e.jsx(E,{value:"Your A/c",control:e.jsx(G,{}),label:"Your A/c"}),e.jsx(E,{value:"N.A",control:e.jsx(G,{}),label:"N.A"})]})})]}),e.jsx(s,{item:!0,xs:6,children:e.jsx(a,{fullWidth:!0,label:"Delivery Term",name:"deliveryTerm",value:n.deliveryTerm,onChange:r})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(a,{fullWidth:!0,label:"Lab Report",name:"labReport",value:n.labReport,onChange:r})})]})}),e.jsxs(q,{children:[e.jsx(j,{onClick:o,variant:"contained",sx:{backgroundColor:"#9CA3AF"},children:"Close"}),e.jsx(j,{onClick:m,variant:"contained",sx:{backgroundColor:"#6C2BD9"},children:"Save"})]})]})},re=({open:b,handleClose:o,onSave:A,initialData:i})=>{const[n,h]=d.useState({gstNo:"",gstType:"",placeOfSupply:"",reverseCharge:"",gstRate:"",cgstAmt:"",sgstAmt:"",igstAmt:""});d.useEffect(()=>{i&&h(i)},[i]);const r=C=>{const{name:p,value:u}=C.target;h({...n,[p]:u})},m=()=>{A(n),o()};return e.jsxs(I,{open:b,onClose:o,maxWidth:"md",fullWidth:!0,children:[e.jsxs(_,{sx:{color:"#6C2BD9",fontWeight:600},children:["GST Details",e.jsx(W,{onClick:o,sx:{position:"absolute",right:10,top:10},children:e.jsx(z,{})})]}),e.jsx(O,{dividers:!0,children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(a,{fullWidth:!0,label:"GST No",name:"gstNo",value:n.gstNo,onChange:r})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(a,{fullWidth:!0,label:"GST Type",name:"gstType",value:n.gstType,onChange:r})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(a,{fullWidth:!0,label:"Place Of Supply",name:"placeOfSupply",value:n.placeOfSupply,onChange:r})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(a,{fullWidth:!0,label:"Reverse Charge",name:"reverseCharge",value:n.reverseCharge,onChange:r})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(a,{fullWidth:!0,label:"GST Rate (%)",name:"gstRate",value:n.gstRate,onChange:r})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(a,{fullWidth:!0,label:"CGST Amount",name:"cgstAmt",value:n.cgstAmt,onChange:r})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(a,{fullWidth:!0,label:"SGST Amount",name:"sgstAmt",value:n.sgstAmt,onChange:r})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(a,{fullWidth:!0,label:"IGST Amount",name:"igstAmt",value:n.igstAmt,onChange:r})})]})}),e.jsxs(q,{children:[e.jsx(j,{onClick:o,variant:"contained",sx:{backgroundColor:"#9CA3AF"},children:"Close"}),e.jsx(j,{onClick:m,variant:"contained",sx:{backgroundColor:"#6C2BD9"},children:"Save"})]})]})},ce=()=>{const[b,o]=d.useState(!1),[A,i]=d.useState(!1),[n,h]=d.useState(!1),[r,m]=d.useState(!1),[C,p]=d.useState([]),[u,N]=d.useState([]),[P,S]=d.useState({}),[x,w]=d.useState({}),[B,L]=d.useState([]),[t,F]=d.useState({invoiceType:"",invoiceSubType:"",packingNo:"",invoiceDate:"",customerCode:"",invoiceNo:"",customerName:"",poLogin:"",poNo:"",remark:"",itemCode:"",quantity:"",uom:"",customerItemCode:"",rate:"",amount:"",currency:"",weight:"",discountPer:"",discountAmt:"",netAmt:"",basicAmt:"",cashDiscount:"",traderDiscount:"",dealerDiscount:"",totalAmt:"",packingAmt:"",netTotal:"",ewayBillNo:"",ewayBillDate:"",irnNo:"",ackNo:"",ackDate:"",transporterGST:"",vehicleNo:"",transportMode:""}),c=l=>{const{name:T,value:D}=l.target;F(M=>({...M,[T]:D}))},V=()=>{if(!t.itemCode||!t.quantity){alert("Item Code and Quantity required");return}const l={itemCode:t.itemCode,quantity:Number(t.quantity||0),uom:t.uom,customerItemCode:t.customerItemCode,rate:Number(t.rate||0),amount:Number(t.amount||0),discountPer:Number(t.discountPer||0),discountAmt:Number(t.discountAmt||0),netAmount:Number(t.netAmt||0)};L(T=>[...T,l]),F(T=>({...T,itemCode:"",quantity:"",uom:"",customerItemCode:"",rate:"",amount:"",discountPer:"",discountAmt:"",netAmt:""}))},Y=async()=>{try{if(!t.invoiceNo){alert("Invoice Number required");return}if(B.length===0){alert("Add at least one item");return}const l=t.invoiceNo,T=t.invoiceDate?new Date(t.invoiceDate).toISOString():new Date().toISOString(),D={invoicE_HED_ex:{inV_TYPE:t.invoiceType,saleS_TYPE:t.invoiceSubType,inV_NO:l,inV_DT:T,cusT_CODE:t.customerCode,consiN_NAME:t.customerName,remark:t.remark||"",user_name:"admin",disC_PER:Number(t.discountPer||0),disC_AMT:Number(t.discountAmt||0),totaL_AMT:Number(t.totalAmt||0),neT_AMT:Number(t.netTotal||0),pacK_AMT:Number(t.packingAmt||0),cgst_amt:Number((x==null?void 0:x.cgst_amt)||0),sgst_amt:Number((x==null?void 0:x.sgst_amt)||0),igst_amt:Number((x==null?void 0:x.igst_amt)||0),sgstper:Number((x==null?void 0:x.sgstper)||0),cgstper:Number((x==null?void 0:x.cgstper)||0),igstper:Number((x==null?void 0:x.igstper)||0)},list_INVOICE_DET_ex:B.map(g=>({inV_NO:l,inV_DT:T,iteM_CODE:g.itemCode,quantity:Number(g.quantity),uom:g.uom,rate:Number(g.rate),amount:Number(g.amount),neT_AMT:Number(g.netAmount),disC_PER:Number(g.discountPer||0),disC_AMT:Number(g.discountAmt||0),cusT_ITEM_CODE:g.customerItemCode||""})),list_Inv_tax_ex:u.map(g=>({inV_NO:l,inV_DT:T,taX_CODE:g.taxCode,taX_AMT:Number(g.taxAmount||0)})),list_Inv_pay_ex:C.map((g,H)=>({inV_NO:l,inV_DT:T,percentage:Number(g.percentage||0),mode:g.paymentMode||"C",period:Number(g.period||0),sR_NO:H+1}))};console.log("FINAL PAYLOAD:",D);const M=await ne(D);alert("Invoice Saved Successfully"),console.log("API RESPONSE:",M)}catch(l){console.error(l),alert(l.message||"Something went wrong")}};return e.jsxs(Z,{maxWidth:"xl",children:[e.jsx(v,{className:"breadcrumb",children:e.jsx($,{routeSegments:[{name:"Sales"},{name:"Invoice"}]})}),e.jsxs(v,{sx:{background:"#fff",p:3,borderRadius:2},children:[e.jsxs(v,{display:"grid",gridTemplateColumns:"3fr 1fr",gap:3,children:[e.jsxs(v,{children:[e.jsxs(v,{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:2,children:[e.jsx(a,{label:"Invoice Type",name:"invoiceType",value:t.invoiceType,onChange:c,size:"small"}),e.jsx(a,{label:"Invoice Sub Type",name:"invoiceSubType",value:t.invoiceSubType,onChange:c,size:"small"}),e.jsx(a,{label:"Packing No.",name:"packingNo",value:t.packingNo,onChange:c,size:"small"}),e.jsx(a,{type:"date",label:"Date",name:"invoiceDate",value:t.invoiceDate,onChange:c,size:"small",InputLabelProps:{shrink:!0}}),e.jsx(a,{label:"Customer",name:"customerCode",value:t.customerCode,onChange:c,size:"small"}),e.jsx(a,{label:"Inv. No",name:"invoiceNo",value:t.invoiceNo,onChange:c,size:"small"}),e.jsx(a,{label:"Customer Name",name:"customerName",value:t.customerName,onChange:c,size:"small"}),e.jsx(a,{label:"PO Login",name:"poLogin",value:t.poLogin,onChange:c,size:"small"}),e.jsx(a,{label:"PO No.",name:"poNo",value:t.poNo,onChange:c,size:"small"}),e.jsx(a,{label:"Remark",name:"remark",value:t.remark,onChange:c,size:"small",multiline:!0,rows:1})]}),e.jsx(ee,{sx:{my:3}}),e.jsxs(v,{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:2,children:[e.jsx(a,{label:"Item Code",name:"itemCode",value:t.itemCode,onChange:c,size:"small"}),e.jsx(a,{label:"Quantity",name:"quantity",value:t.quantity,onChange:c,size:"small"}),e.jsx(a,{label:"UOM",name:"uom",value:t.uom,onChange:c,size:"small"}),e.jsx(a,{label:"Customer Item Code",name:"customerItemCode",value:t.customerItemCode,onChange:c,size:"small"}),e.jsx(a,{label:"Rate",name:"rate",value:t.rate,onChange:c,size:"small"}),e.jsx(a,{label:"Amount",name:"amount",value:t.amount,onChange:c,size:"small"})]}),e.jsxs(v,{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:2,mt:2,children:[e.jsx(a,{label:"Currency",size:"small"}),e.jsx(a,{label:"Weight",size:"small"}),e.jsx(a,{label:"Discount (%)",size:"small"}),e.jsx(a,{label:"Discount Amt",size:"small"}),e.jsx(a,{label:"Net Amt",size:"small"})]}),e.jsx(v,{textAlign:"center",mt:3,children:e.jsx(j,{variant:"contained",color:"secondary",onClick:V,children:"OK"})})]}),e.jsxs(v,{sx:{border:"1px solid #eee",borderRadius:2,p:2,background:"#fafafa"},children:[e.jsx(a,{label:"Basic Amt.",name:"basicAmt",value:t.basicAmt,onChange:c,size:"small",fullWidth:!0,sx:{mb:2}}),e.jsx(a,{label:"Cash Discount",size:"small",fullWidth:!0,sx:{mb:2}}),e.jsx(a,{label:"Trader Discount",size:"small",fullWidth:!0,sx:{mb:2}}),e.jsx(a,{label:"Dealer Discount",size:"small",fullWidth:!0,sx:{mb:2}}),e.jsx(a,{label:"Total Amount",name:"totalAmt",value:t.totalAmt,onChange:c,size:"small",fullWidth:!0,sx:{mb:2}}),e.jsx(a,{label:"Packing & Fwd.",name:"packingAmt",value:t.packingAmt,onChange:c,size:"small",fullWidth:!0,sx:{mb:2}}),e.jsx(a,{label:"Net Total",name:"netTotal",value:t.netTotal,onChange:c,size:"small",fullWidth:!0,sx:{mb:3}}),e.jsxs(v,{display:"flex",flexDirection:"column",gap:1,children:[e.jsx(j,{variant:"contained",onClick:()=>o(!0),children:"Payment Terms"}),e.jsx(j,{variant:"contained",onClick:()=>i(!0),children:"Tax Details"}),e.jsx(j,{variant:"contained",onClick:()=>h(!0),children:"Other Details"}),e.jsx(j,{variant:"contained",onClick:()=>m(!0),children:"GST Details"}),e.jsx(j,{variant:"contained",children:"Transport Details"})]})]})]}),e.jsx(v,{mt:4,textAlign:"right",children:e.jsx(j,{variant:"contained",startIcon:e.jsx(te,{children:"save"}),onClick:Y,children:e.jsx(ae,{children:"Save"})})}),e.jsx(le,{open:b,onClose:()=>o(!1),onSave:l=>{p(l),o(!1),console.log("Saved Payment Terms:",l)}}),e.jsx(se,{open:A,onClose:()=>i(!1),onSave:l=>{N(l),i(!1),console.log("Saved Tax Data:",l)}}),e.jsx(ie,{open:n,onClose:()=>h(!1),onSave:l=>{S(l),h(!1),console.log("Saved Other Details:",l)}}),e.jsx(re,{open:r,onClose:()=>m(!1),onSave:l=>{w(l),m(!1),console.log("Saved GST Details:",l)}})]})]})};export{ce as default};
