import{U as D,W as F,r as o,j as e,bg as w,B as d,q as k,n as M,af as z,S as O,G as i,ab as g,V as r,M as y,ac as R,ad as c,ae as u,w as W,bt as B,bu as L,bv as A}from"./index-DGO-Ln70.js";const G={employeeCode:"",employeeName:"",email:"",contactNo:"",gender:"",agreedToTerms:!1},q=()=>{const f=D(),h=F(),[s,p]=o.useState({...G}),[j,C]=o.useState([]),[m,b]=o.useState("new"),[v,x]=o.useState(!1),n=a=>{const{name:t,value:l,type:_,checked:I}=a.target;p(T=>({...T,[t]:_==="checkbox"?I:l}))},N=async()=>{try{const a=localStorage.getItem("PROFCEN_CD")||"";if(!a)return;const t=await B(a);t!=null&&t.data&&C(t.data)}catch(a){console.error("Employee dropdown error:",a)}},S=async a=>{try{const t=await L(a);if(t!=null&&t.data){const l=t.data;p({employeeCode:l.emp_no??"",employeeName:l.sman_name??"",email:l.semail??"",contactNo:l.scontact_no??"",gender:l.gender??"",agreedToTerms:!1})}}catch(t){console.error("Edit fetch error:",t)}},E=async()=>{if(!s.employeeCode||!s.employeeName||!s.email||!s.contactNo){alert("Please fill all required fields");return}const a=s.employeeName.trim().split(" "),t={emp_no:s.employeeCode,sman_name:s.employeeName,fname:a[0]||"",mname:a.length===3?a[1]:"",lname:a.length===3?a[2]:a.length===2?a[1]:"",semail:s.email,scontact_no:s.contactNo,gender:s.gender};try{x(!0),await A(t),alert(m==="edit"?"Salesman updated successfully!":"Salesman added successfully!"),f("/material/salesman")}catch(l){console.error("Save Error:",l),alert("Failed to save salesman")}finally{x(!1)}};return o.useEffect(()=>{var a;N(),(a=h.state)!=null&&a.employeeCode&&(b("edit"),S(h.state.employeeCode))},[]),e.jsxs(w,{maxWidth:"xl",children:[e.jsx(d,{className:"breadcrumb",children:e.jsx(k,{routeSegments:[{name:"Sales"},{name:"Salesman Details"}]})}),e.jsxs(d,{sx:{background:"#fff",p:3,borderRadius:2},children:[e.jsxs(d,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx("h2",{children:"Salesman Details"}),e.jsx(M,{variant:"contained",startIcon:e.jsx(z,{children:"save"}),onClick:E,disabled:v,children:e.jsx(O,{children:m==="edit"?"Update":"Save"})})]}),e.jsxs(i,{container:!0,spacing:2,children:[e.jsx(i,{size:{md:6,xs:12},sx:{mt:2},children:e.jsxs(g,{spacing:3,children:[e.jsxs(r,{size:"small",select:!0,fullWidth:!0,name:"employeeCode",label:"Employee Code",value:s.employeeCode,onChange:n,disabled:m==="edit",children:[e.jsx(y,{value:"",children:"-- Select Employee --"}),j.map(a=>e.jsxs(y,{value:a.emp_no,children:[a.emp_no," ",a.fname," ",a.mname," ",a.lname]},a.emp_no))]}),e.jsx(r,{size:"small",fullWidth:!0,name:"employeeName",label:"Employee Name",value:s.employeeName,onChange:n}),e.jsx(r,{size:"small",fullWidth:!0,name:"email",label:"Email ID",type:"email",value:s.email,onChange:n}),e.jsx(r,{size:"small",fullWidth:!0,name:"contactNo",label:"Contact No",value:s.contactNo,onChange:n})]})}),e.jsx(i,{size:{md:6,xs:12},sx:{mt:2},children:e.jsxs(g,{spacing:3,children:[e.jsxs(R,{row:!0,name:"gender",value:s.gender,onChange:n,children:[e.jsx(c,{value:"Male",label:"Male",control:e.jsx(u,{})}),e.jsx(c,{value:"Female",label:"Female",control:e.jsx(u,{})}),e.jsx(c,{value:"Others",label:"Others",control:e.jsx(u,{})})]}),e.jsx(c,{control:e.jsx(W,{name:"agreedToTerms",checked:s.agreedToTerms,onChange:n}),label:"I have read and agree to the terms of service."})]})})]})]})]})};export{q as default};
